@{
    Layout = "_Layout";
    int counter = 1;
}

@model WebSchool.ViewModels.User.TeacherViewModel

<div class="row">
    <div class="col-md-6 offset-3">
        <form method="post">
            <input type="hidden" value="@Model.Id" name="id" />
            <div class="form-group">
                <label asp-for="FirstName">Firstname</label>
                <input asp-for="FirstName" disabled class="form-control" />
            </div>
            <div class="form-group">
                <label asp-for="LastName">Lastname</label>
                <input asp-for="LastName" disabled class="form-control" />
            </div>
            <div class="form-group">
                <select class="custom-select" name="signature" id="classesSelect">
                </select>
            </div>
            <button class="btn btn-primary w-100">Assign</button>
        </form>
    </div>
</div>

<div class="row mt-5">
    <div class="col-md-10 offset-1">
        <table class="table table-striped table-hover">
            <thead>
                <tr>
                    <th scope="col">#</th>
                    <th scope="col">Signature</th>
                    <th scope="col">Delete</th>
                </tr>
            </thead>
            <tbody id="linksTable">
                @foreach (var classes in Model.Classes)
                {
                    <tr>
                        <td scope="col">@(counter++)</td>
                        <td scope="col">@classes.Signature</td>
                        <td scope="col"><a asp-area="Admin" asp-controller="Classes" asp-action="RemoveClass" asp-route-classId="@classes.Id" asp-route-teacherId="@Model.Id" class="btn btn-primary w-50 text-white">Remove</a></td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>

@section Scripts {
    <script>
        const select = document.getElementById('classesSelect');
        const xhttp = new XMLHttpRequest();

        xhttp.onreadystatechange = function () {
            if (this.readyState == 4 && this.status == 200) {
                let data = JSON.parse(this.responseText);
                for (let i = 0; i < data.length; i++) {
                    select.innerHTML += `<option value='` + data[i].signature + `'>` + data[i].signature + `</option>`;
                }
            }
        }

        xhttp.open("GET", "/Admin/Classes/GetTeacherClasses?teacherId=@Model.Id", true);
        xhttp.send();
    </script>
}